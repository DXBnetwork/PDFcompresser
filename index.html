<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PDF Split & Download Test</title>
</head>
<body>
  <h1>Test Download</h1>
  <input type="file" id="pdfFile" accept="application/pdf"><br>
  <button id="go">Go</button>

  <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
  <script>
    document.getElementById('go').addEventListener('click', async () => {
      const f = document.getElementById('pdfFile').files[0];
      if (!f) return alert('Pick a PDF');
      const arrayBuffer = await f.arrayBuffer();
      const src = await PDFLib.PDFDocument.load(arrayBuffer);

      // *** SPLIT LOGIC: here we just take the first page ***
      const out = await PDFLib.PDFDocument.create();
      const [p] = await out.copyPages(src, [0]);
      out.addPage(p);
      const pdfBytes = await out.save();

      // *** DOWNLOAD KICKOFF ***
      const blob = new Blob([pdfBytes], { type: 'application/pdf' });
      const url  = URL.createObjectURL(blob);
      const a    = document.createElement('a');
      a.href     = url;
      a.download = 'part1.pdf';
      document.body.appendChild(a);
      a.click();             // ‚Üê this must be inside your click handler!
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    });
  </script>
</body>
</html>
